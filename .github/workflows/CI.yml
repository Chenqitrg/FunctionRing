# .github/workflows/ci.yml
name: CI

on:
  push:
    branches: [ main, master ]
  pull_request:
    branches: [ main, master ]

jobs:
  test:
    runs-on: ubuntu-latest

    strategy:
      matrix:
        julia-version: ['1.11']     # add '1.10', '1.9', 'nightly' if you like

    steps:
      # 1. Check out the repository **into $GITHUB_WORKSPACE**
      - uses: actions/checkout@v4

      # 2. Install Julia
      - uses: julia-actions/setup-julia@v1
        with:
          version: ${{ matrix.julia-version }}

      # 3. Instantiate (always from the repo root)
      - name: Instantiate
        working-directory: ${{ github.workspace }}
        run: |
          julia --color=yes -e '
            using Pkg
            Pkg.activate(".")
            Pkg.instantiate()
          '

      # 4. Run the tests
      - name: Test
        working-directory: ${{ github.workspace }}
        run: |
          julia --color=yes -e '
            using Pkg
            Pkg.activate(".")             # activate package environment
            Pkg.test("ConformalCalculator";      # specify the package explicitly
                     coverage=true)
          '